<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offlineIndicator">Online</div><meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Communication Scripts - CARING COMPASSION</title>
    <meta name="description" content="Trauma-informed communication scripts for healthcare providers">
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;Communication Scripts&quot;,&quot;short_name&quot;:&quot;Scripts&quot;,&quot;start_url&quot;:&quot;.&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;theme_color&quot;:&quot;#4facfe&quot;}">
    <meta name="theme-color" content="#4facfe">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            touch-action: manipulation;
        }

        .welcome-screen {
            background: white;
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            margin: 20px auto;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .training-logo {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .training-title {
            font-size: 1.4rem;
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .training-subtitle {
            color: #6c757d;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .tool-name {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .quick-instructions {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: left;
        }

        .instruction-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .instruction-list {
            list-style: none;
            padding: 0;
        }

        .instruction-list li {
            padding: 8px 0;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 15px;
        }

        .start-btn:active {
            transform: scale(0.98);
        }

        .bookmark-hint {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #856404;
        }

        .bookmark-icon {
            font-size: 1.2rem;
            margin-right: 8px;
        }

        /* Main app styles */
        .app-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            margin: 0 auto;
            overflow: hidden;
            display: none;
        }

        .app-container.active {
            display: block;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .back-btn {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .search-container {
            padding: 15px;
            background: #f8f9fa;
        }

        .search-input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            margin-bottom: 15px;
        }

        .search-input:focus {
            border-color: #4facfe;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .filter-btn.active {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }

        .scripts-container {
            padding: 20px 15px;
            max-height: 70vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .script-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .script-card:active {
            transform: scale(0.98);
        }

        .card-header {
            padding: 15px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            position: relative;
        }

        .situation-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            padding-right: 60px;
        }

        .situation-context {
            font-size: 0.9rem;
            color: #555;
            opacity: 0.8;
            line-height: 1.3;
        }

        .category-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            color: #495057;
        }

        .card-content {
            padding: 15px;
        }

        .script-section {
            margin-bottom: 15px;
        }

        .section-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .dont-say {
            background: #ffe6e6;
            padding: 12px;
            border-radius: 10px;
            border-left: 4px solid #dc3545;
            margin-bottom: 12px;
        }

        .do-say {
            background: #e8f5e8;
            padding: 12px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }

        .script-text {
            font-size: 0.9rem;
            line-height: 1.4;
            color: #333;
            font-style: italic;
        }

        .cultural-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 12px;
            margin-top: 12px;
        }

        .cultural-note-title {
            font-weight: 600;
            color: #856404;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
        }

        .cultural-note-text {
            font-size: 0.8rem;
            color: #856404;
            line-height: 1.3;
        }

        .card-actions {
            padding: 12px 15px;
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            flex: 1;
            justify-content: center;
        }

        .btn-audio {
            background: #ffc107;
            color: #212529;
        }

        .btn-favorite {
            background: #e9ecef;
            color: #495057;
        }

        .btn-favorite.favorited {
            background: #ffc107;
            color: #212529;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .no-results-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .offline-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            z-index: 1000;
        }

        .offline-indicator.offline {
            background: #dc3545;
        }

        @media (max-width: 480px) {
            .welcome-screen, .app-container {
                margin: 5px;
                border-radius: 15px;
            }
            
            .scripts-container {
                padding: 15px 10px;
                max-height: 65vh;
            }
            
            .filter-buttons {
                gap: 5px;
            }
            
            .filter-btn {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="training-logo"></div>
        <div class="training-title">CARING COMPASSION</div>
        <div class="training-subtitle">Trauma-Informed Care Training<br>Southern Philippines Medical Center</div>
        
        <div class="tool-name">
            Communication Scripts Library
        </div>
        
        <div class="quick-instructions">
            <div class="instruction-title">
                How to Use:
            </div>
            <ul class="instruction-list">
                <li>Search for specific patient situations</li>
                <li>Filter by medical specialty or behavior type</li>
                <li>Compare harmful vs. healing responses</li>
                <li>Cultural notes for Filipino patients</li>
                <li>Audio playback for proper delivery</li>
            </ul>
        </div>
        
        <button class="start-btn" onclick="startApp()">
            Browse Scripts
        </button>
        
        <div class="bookmark-hint">
            <strong>Tip:</strong> Save to home screen for quick reference during patient interactions!
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer">
        <div class="header">
            <button class="back-btn" onclick="showWelcome()">←</button>
            <h1>Communication Scripts</h1>
            <p>Trauma-Informed Patient Care</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="Search scenarios..." id="searchInput">
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="gynecological">GYN</button>
                <button class="filter-btn" data-filter="prenatal">Prenatal</button>
                <button class="filter-btn" data-filter="emergency">Emergency</button>
                <button class="filter-btn" data-filter="difficult">Difficult</button>
            </div>
        </div>

        <div class="scripts-container" id="scriptsContainer">
            <!-- Scripts will be loaded here -->
        </div>
    </div>

    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offlineIndicator">📶 Online</div>

    <script>
        // Simplified scripts for mobile
        const communicationScripts = [
            {
                id: 1,
                category: "gynecological",
                title: "Patient Tenses During Pelvic Exam",
                context: "Patient suddenly becomes tense and distressed during routine examination",
                dontSay: "Just relax, this will be over soon. You need to stay still.",
                doSay: "I notice you seem uncomfortable. We can pause anytime. What would help you feel more comfortable?",
                culturalNote: "Filipino women may feel extra shame discussing intimate areas. Allow family member presence if requested."
            },
            {
                id: 2,
                category: "prenatal",
                title: "Anxious First-Time Mother",
                context: "Pregnant patient expressing excessive worry about complications",
                dontSay: "Don't worry so much. Everything looks normal. You're overthinking this.",
                doSay: "I can see you're worried about your baby. That shows how much you care. Let's address your concerns one by one.",
                culturalNote: "Filipino mothers often carry family anxiety. Acknowledge collective concern while empowering the individual."
            },
            {
                id: 3,
                category: "difficult",
                title: "Angry About Wait Time",
                context: "Patient becomes agitated about delayed appointment",
                dontSay: "You need to calm down. We're doing our best. Getting angry won't help.",
                doSay: "I can see you're frustrated about the wait. Your time is valuable. Let me see what I can do to help.",
                culturalNote: "Public anger may indicate significant distress in Filipino culture. Treat with extra compassion."
            },
            {
                id: 4,
                category: "emergency",
                title: "Sexual Assault Survivor",
                context: "Patient after assault, withdrawn and reluctant to discuss details",
                dontSay: "I need to know exactly what happened. We have to do this exam now for evidence.",
                doSay: "I'm so sorry this happened. You're safe now. We'll only do what you consent to. What do you need?",
                culturalNote: "Sexual assault carries significant stigma. Ensure complete privacy and same-gender staff if available."
            },
            {
                id: 5,
                category: "gynecological",
                title: "Patient Dissociates During Procedure",
                context: "Patient appears 'checked out' with vacant stare during exam",
                dontSay: "Are you paying attention? I need you to focus. You're not even here.",
                doSay: "I'm going to pause. I notice you seem far away, which is normal. Feel your feet and tell me when ready.",
                culturalNote: "Dissociation may be unfamiliar to families. Brief education helps normalize the response."
            },
            {
                id: 6,
                category: "prenatal",
                title: "Domestic Violence Concerns",
                context: "Subtle signs suggest possible domestic violence during prenatal visit",
                dontSay: "Is your husband hurting you? You need to leave him. Why don't you call police?",
                doSay: "You deserve to be treated with kindness. If you need support or resources, I'm here without judgment.",
                culturalNote: "DV has complex cultural factors. Provide resources without pressuring immediate action."
            },
            {
                id: 7,
                category: "difficult",
                title: "Refuses Recommended Treatment",
                context: "Patient adamantly refusing necessary treatment despite explanations",
                dontSay: "You're being unreasonable. I'm the doctor. You'll regret this decision.",
                doSay: "I see you have concerns about this treatment. Help me understand what worries you most.",
                culturalNote: "Medical decisions often involve extended family. Allow time for consultation."
            },
            {
                id: 8,
                category: "emergency",
                title: "Trauma Patient in Shock",
                context: "Accident victim appears disconnected, gives inconsistent information",
                dontSay: "Tell me where it hurts. Your answers don't make sense. Try to focus.",
                doSay: "You've been through something scary. Your body is protecting you. I'll take good care of you.",
                culturalNote: "Filipino patients may minimize pain to avoid complaining. Look for non-verbal distress signs."
            }
        ];

        let currentFilter = 'all';
        let favorites = JSON.parse(localStorage.getItem('favoriteScripts') || '[]');

        function startApp() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('appContainer').classList.add('active');
            renderScripts();
            setupEventListeners();
        }

        function showWelcome() {
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('appContainer').classList.remove('active');
        }

        function renderScripts() {
            const container = document.getElementById('scriptsContainer');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            let filteredScripts = communicationScripts.filter(script => {
                const matchesFilter = currentFilter === 'all' || script.category === currentFilter;
                const matchesSearch = script.title.toLowerCase().includes(searchTerm) ||
                                    script.context.toLowerCase().includes(searchTerm) ||
                                    script.doSay.toLowerCase().includes(searchTerm);
                return matchesFilter && matchesSearch;
            });

            if (filteredScripts.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon"></div>
                        <div>No scripts found</div>
                        <div style="font-size: 0.8rem; margin-top: 5px;">Try adjusting your search or filter</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredScripts.map(script => `
                <div class="script-card" data-id="${script.id}">
                    <div class="card-header">
                        <div class="category-badge">${script.category}</div>
                        <div class="situation-title">${script.title}</div>
                        <div class="situation-context">${script.context}</div>
                    </div>
                    <div class="card-content">
                        <div class="script-section">
                            <div class="section-label">Instead of saying:</div>
                            <div class="dont-say">
                                <div class="script-text">"${script.dontSay}"</div>
                            </div>
                        </div>
                        <div class="script-section">
                            <div class="section-label">Try saying:</div>
                            <div class="do-say">
                                <div class="script-text">"${script.doSay}"</div>
                            </div>
                        </div>
                        ${script.culturalNote ? `
                            <div class="cultural-note">
                                <div class="cultural-note-title">Cultural Note:</div>
                                <div class="cultural-note-text">${script.culturalNote}</div>
                            </div>
                        ` : ''}
                    </div>
                    <div class="card-actions">
                        <button class="action-btn btn-audio" onclick="playScript(${script.id})">
                            Listen
                        </button>
                        <button class="action-btn btn-favorite ${favorites.includes(script.id) ? 'favorited' : ''}" 
                                onclick="toggleFavorite(${script.id})">
                            ${favorites.includes(script.id) ? 'Saved' : 'Save'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', renderScripts);
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    renderScripts();
                });
            });
        }

        function toggleFavorite(scriptId) {
            const index = favorites.indexOf(scriptId);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(scriptId);
            }
            localStorage.setItem('favoriteScripts', JSON.stringify(favorites));
            renderScripts();
        }

        function playScript(scriptId) {
            const script = communicationScripts.find(s => s.id === scriptId);
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(script.doSay);
                utterance.rate = 0.8;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            } else {
                alert('Audio not supported in this browser');
            }
        }

        // Offline detection
        function updateOnlineStatus() {
            const indicator = document.getElementById('offlineIndicator');
            if (navigator.onLine) {
                indicator.textContent = 'Online';
                indicator.classList.remove('offline');
            } else {
                indicator.textContent = 'Offline';
                indicator.classList.add('offline');
            }
        }

        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (document.getElementById('appContainer').classList.contains('active')) {
                if (event.key === 'Escape') {
                    showWelcome();
                }
                if (event.key === '/') {
                    event.preventDefault();
                    document.getElementById('searchInput').focus();
                }
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateOnlineStatus();
        });
    </script>
</body>
</html>
